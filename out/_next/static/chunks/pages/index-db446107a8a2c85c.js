(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(5855)}])},5855:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var s=a(5893),n=a(7294);let l=e=>{let{streamLink:t,showStatic:a,name:l,stopRecording:r}=e,i=(0,n.useCallback)(e=>{if(!e)return;if(a){e.srcObject=null,e.play();return}let s=new RTCPeerConnection;s.ontrack=t=>{e.srcObject=t.streams[0],e.play()},s.addTransceiver("video",{direction:"recvonly"}),s.onnegotiationneeded=async()=>{let e=await s.createOffer();await s.setLocalDescription(e);try{let e=await fetch(t,{method:"POST",body:new URLSearchParams({data:btoa(s.localDescription.sdp)})}),a=await e.text();await s.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:atob(a)}))}catch(e){console.error(e);return}}},[t,a]);return(0,s.jsxs)("div",{className:"relative flex-1 w-0 bg-black",children:[(0,s.jsx)("video",{className:"w-full h-full",ref:i,muted:!0,autoPlay:!0,loop:!0,children:(0,s.jsx)("source",{src:"/static.mp4",type:"video/mp4"})}),!r&&(0,s.jsx)("div",{className:"absolute top-4 left-4 w-6 h-6 rounded-full bg-red-600 animate-blink"}),(0,s.jsx)("span",{className:"absolute top-4 right-4 bg-black text-white",children:l})]})};var r=a(623),i=a(903),c=a(6962),o=a(1616),u=a.n(o);function d(e){let{success:t,visible:a}=e;return a?(0,s.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 translate-y-1/2 text-6xl pointer-events-none z-50",children:(0,s.jsx)("span",{className:"text-6xl p-4 "+(t?"bg-green-600":"bg-red-600"),children:t?"ACCESS GRANTED":"ACCESS DENIED"})}):null}function m(e){let{onDisableCameras:t}=e,[a,l]=(0,n.useState)(""),[o,u]=(0,n.useState)(!1),[m,b]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1);return(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsxs)("form",{className:"mt-7 mb-7",onSubmit:e=>{o||(b(!0),setTimeout(()=>b(!1),2e3)),"pica$50"!==a||o||u(!0),e.preventDefault()},children:[(0,s.jsx)("label",{htmlFor:"pw",children:"Enter password:"}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"text",name:"pw",className:"outline outline-1 h-6",value:a,onChange:e=>l(e.target.value),disabled:o}),(0,s.jsx)("button",{type:"submit",className:"outline outline-1 ml-1",disabled:o,children:(0,s.jsx)(r,{className:"w-6 h-6 mt-auto mb-auto"})})]})]}),(0,s.jsxs)("div",{className:"relative overflow-visible whitespace-nowrap",children:[(0,s.jsx)(d,{success:o,visible:m}),(0,s.jsxs)("button",{className:"relative m-6 p-3 text-lg animate-none "+(o?h?"bg-gray-300 pointer-events-none text-gray-400 line-through":"bg-green-400 hover:bg-green-500":"bg-gray-300 pointer-events-none text-gray-400"),onClick:()=>{p(!0),t()},disabled:!o,children:["Disable cameras",o?h?(0,s.jsx)(c,{className:"absolute h-12 top-1/2 right-0 translate-x-full -translate-y-1/2 text-green-500"}):(0,s.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 -m-3 bg-green-200 -z-10 animate-fade"}):(0,s.jsx)(i,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 text-black"})]})]})]})}function b(){let[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(!1),i="muddescapes/data/Security Cameras/disabled";return(0,n.useEffect)(()=>{let e=u().connect("wss://broker.hivemq.com:8884",{path:"/mqtt"});function a(){r(t=>(e.publish(i,t?"1":"0",{qos:2}),t))}return e.on("connect",()=>{console.debug("connected"),a(),e.subscribe("muddescapes",{qos:2})}),e.on("message",(e,t)=>{a()}),t(e),()=>{e.end()}},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(l,{name:"Camera 1 - Main Gallery",showStatic:a,streamLink:"http://localhost:8083/stream/cam1/channel/0/webrtc?uuid=cam1&channel=0",stopRecording:a}),(0,s.jsx)(l,{name:"Camera 2 - Security",showStatic:a,streamLink:"http://localhost:8083/stream/cam2/channel/0/webrtc?uuid=cam2&channel=0",stopRecording:a})]}),(0,s.jsx)(m,{onDisableCameras:()=>{r(!0),null==e||e.publish(i,"1",{qos:2})}})]})}},1784:function(){},5036:function(){},2361:function(){},4616:function(){}},function(e){e.O(0,[293,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);